<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ddol.jwtd9.product.model.dao.ProductMapper">

    <select id="countAllProduct" resultType="_int">
        SELECT COUNT(*)
          FROM PRODUCT
    </select>

    <select id="selectAllRangedProductList" parameterType="java.util.Map" resultType="ProductDTO">
        SELECT
            P.PRODUCT_CODE,
            P.CATEGORY_CODE,
            C.CATEGORY_NAME,
            P.PRODUCT_NAME,
            P.PRODUCT_PRICE,
            P.PRODUCT_DESCRIPTION,
            P.PRODUCT_ORDERABLE,
            P.PRODUCT_STOCK,
            P.PRODUCT_IMAGE_URL
        FROM (SELECT
                    ROWNUM RNUM,
                    A.PRODUCT_CODE,
                    A.CATEGORY_CODE,
                    A.PRODUCT_NAME,
                    A.PRODUCT_PRICE,
                    A.PRODUCT_DESCRIPTION,
                    A.PRODUCT_ORDERABLE,
                    A.PRODUCT_STOCK,
                    A.PRODUCT_IMAGE_URL
              FROM PRODUCT A
            ) P
        JOIN CATEGORY C ON (C.CATEGORY_CODE = P.CATEGORY_CODE)
        WHERE P.RNUM BETWEEN #{ minIndex } AND #{ maxIndex }
    </select>

    <select id="selectProduct" resultType="ProductDTO">
        SELECT COUNT(*)
        FROM PRODUCT
    </select>

    <insert id="insertProduct" parameterType="ProductDTO">
        INSERT INTO PRODUCT
        (
        PRODUCT_CODE
        , CATEGORY_CODE
        , PRODUCT_NAME
        , PRODUCT_PRICE
        , PRODUCT_DESCRIPTION
        , PRODUCT_ORDERABLE
        , PRODUCT_STOCK
        , PRODUCT_IMAGE_URL
        )
        VALUES
            (
            'P'||SEQ_PRODUCT_CODE.NEXTVAL
            , #{categoryCode}
            , #{productName}
            , #{productPrice}
            , #{productDescription}
            , #{productOrderable}
            , #{productStock}
            , #{productImageUrl}
            )
    </insert>

</mapper>